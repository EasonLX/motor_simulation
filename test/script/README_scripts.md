# 负载转动惯量测试仿真脚本说明

## 脚本概览

基于**100Nm峰值扭矩**和**0.3m摆杆长度限制**重新设计的测试脚本：

| 脚本 | 功能 | 特点 |
|------|------|------|
| `1_inertia_range.py` | 转动惯量范围计算 | 输出CSV供结构参考 |
| `2_simulate_configurations.py` | 多配置仿真验证 | 实时波形显示 |
| `3_quick_test.py` | 快速单配置测试 | 简化版实时显示 |
| `4_font_check.py` | 字体检查工具 | 解决中文显示问题 |
| `6_load_inertia_test.py` | **专业测试模板** | 完整测试流程 |

## 参数配置

### 电机参数
- **峰值扭矩**: 100 Nm
- **额定扭矩**: 50 Nm
- **控制范围**: ±100 Nm

### 摆杆参数
- **最大长度**: 0.3 m
- **半径**: 0.015 m (直径30mm)
- **材料**: 铝材 (密度2700 kg/m³)

### 测试配置

#### 空载测试
- 摆杆长度: 0.2 m
- 重量块: 0 kg
- 预期转动惯量: ~0.001 kg·m²
- 预期最大力矩: ~5 Nm

#### 中负载测试
- 摆杆长度: 0.25 m
- 重量块: 2 kg (末端)
- 预期转动惯量: ~0.15 kg·m²
- 预期最大力矩: ~30 Nm

#### 大负载测试
- 摆杆长度: 0.3 m
- 重量块: 4 kg (末端)
- 预期转动惯量: ~0.4 kg·m²
- 预期最大力矩: ~80 Nm

## 使用方法

### 1. 计算转动惯量范围
```bash
python script/1_inertia_range.py
```
- 输出: `inertia_range_results.csv`
- 用途: 供结构设计参考

### 2. 多配置仿真验证
```bash
python script/2_simulate_configurations.py
```
- 依次测试三种配置
- 实时显示波形
- 详细统计输出

### 3. 快速测试
```bash
python script/3_quick_test.py
```
- 单配置快速验证
- 15秒测试
- 简化界面

### 4. 专业测试模板
```bash
python script/6_load_inertia_test.py
```
- 完整测试流程
- 自动分析结果
- 力矩利用率评估

## 性能优化

### 实时绘图优化
- **绘图频率**: 每30-50仿真步更新一次
- **窗口大小**: 1000-1500数据点
- **字体设置**: 使用系统中文字体

### 仿真速度
- **时间步长**: 0.001s
- **控制频率**: 1000Hz
- **绘图开销**: 减少到最小

## 输出分析

### 位置跟踪
- RMS误差 (rad 和 度)
- 最大误差
- 跟踪精度评估

### 速度跟踪
- RMS误差 (rad/s)
- 最大速度
- 响应性能

### 控制力矩
- 最大力矩 (Nm)
- 平均力矩
- RMS力矩
- 力矩利用率 (%)

## 注意事项

1. **字体问题**: 如遇中文显示问题，运行 `4_font_check.py`
2. **仿真速度**: 实时绘图会降低仿真速度，可关闭绘图提高性能
3. **力矩限制**: 确保测试配置不超过100Nm峰值扭矩
4. **摆杆长度**: 不超过0.3m限制

## 文件结构

```
script/
├── 1_inertia_range.py          # 转动惯量计算
├── 2_simulate_configurations.py # 多配置仿真
├── 3_quick_test.py             # 快速测试
├── 4_font_check.py             # 字体检查
├── 6_load_inertia_test.py      # 专业测试模板
└── README_scripts.md           # 本说明文档
```

## 扩展使用

### 自定义配置
修改 `6_load_inertia_test.py` 中的 `test_configs` 来添加自定义测试配置：

```python
configs.append({
    'name': '自定义测试',
    'arm_length': 0.28,
    'weight_mass': 3.0,
    'weight_position': 0.28,
    'expected_inertia': 0.25,
    'max_torque_expected': 60.0
})
```

### 批量测试
可以修改脚本实现批量自动化测试，生成测试报告。
